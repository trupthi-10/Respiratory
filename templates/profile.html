{% extends "base.html" %}

{% block title %}Profile - Healthcare App{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title mb-0">
                    <i class="fas fa-user-edit me-2"></i>Edit Profile
                </h5>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-md-4 text-center mb-4">
                            <div class="mb-3">
                                <img src="{{ url_for('static', filename='uploads/profiles/' + current_user.profile_pic) }}" 
                                     class="profile-pic rounded-circle" alt="Profile Picture">
                            </div>
                            <div class="mb-3">
                                <label for="profile_pic" class="form-label">Change Profile Picture</label>
                                <input type="file" class="form-control" id="profile_pic" name="profile_pic" 
                                       accept="image/*">
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="name" class="form-label">Full Name</label>
                                        <input type="text" class="form-control" id="name" name="name" 
                                               value="{{ current_user.name }}" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Email Address</label>
                                        <input type="email" class="form-control" value="{{ current_user.email }}" 
                                               disabled>
                                        <small class="form-text text-muted">Email cannot be changed</small>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="phone" name="phone" 
                                               value="{{ current_user.phone }}" required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="age" class="form-label">Age</label>
                                        <input type="number" class="form-control" id="age" name="age" 
                                               value="{{ current_user.age }}" required>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="gender" class="form-label">Gender</label>
                                        <select class="form-select" id="gender" name="gender" required>
                                            <option value="Male" {% if current_user.gender == 'Male' %}selected{% endif %}>Male</option>
                                            <option value="Female" {% if current_user.gender == 'Female' %}selected{% endif %}>Female</option>
                                            <option value="Other" {% if current_user.gender == 'Other' %}selected{% endif %}>Other</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="blood_group" class="form-label">Blood Group</label>
                                        <select class="form-select" id="blood_group" name="blood_group" required>
                                            <option value="A+" {% if current_user.blood_group == 'A+' %}selected{% endif %}>A+</option>
                                            <option value="A-" {% if current_user.blood_group == 'A-' %}selected{% endif %}>A-</option>
                                            <option value="B+" {% if current_user.blood_group == 'B+' %}selected{% endif %}>B+</option>
                                            <option value="B-" {% if current_user.blood_group == 'B-' %}selected{% endif %}>B-</option>
                                            <option value="AB+" {% if current_user.blood_group == 'AB+' %}selected{% endif %}>AB+</option>
                                            <option value="AB-" {% if current_user.blood_group == 'AB-' %}selected{% endif %}>AB-</option>
                                            <option value="O+" {% if current_user.blood_group == 'O+' %}selected{% endif %}>O+</option>
                                            <option value="O-" {% if current_user.blood_group == 'O-' %}selected{% endif %}>O-</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="address" class="form-label">Address</label>
                                <textarea class="form-control" id="address" name="address" 
                                          rows="3" required>{{ current_user.address }}</textarea>
                            </div>

                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-save me-2"></i>Update Profile
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Account Information Card -->
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Account Information</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Member Since:</strong> {{ current_user.created_at.strftime('%B %d, %Y') }}</p>
                        <p><strong>Last Login:</strong> Just now</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Total Health Records:</strong> {{ current_user.health_parameters|length }}</p>
                        <p><strong>Medical Reports:</strong> {{ current_user.reports|length }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}